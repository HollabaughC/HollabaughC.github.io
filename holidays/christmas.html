<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Christmas Tree Decorator</title>
  <link rel="icon" type="image/x-icon" href="../img/cam.png">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Orbitron', sans-serif;
      background: #000;
      color: #fff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .page-wrapper { flex: 1; display: flex; flex-direction: column; justify-content: center; padding-top: 140px; padding-bottom: 100px; }
    header {
      position: fixed; top: 0; left: 0; width: 100%;
      padding: 0.5rem 1rem;
      border-bottom: 3px solid #378b29;
      background: rgba(0, 100, 0, 0.9);
      box-shadow: 0 0 25px #378b29, 0 0 50px #ffffff inset;
      z-index: 10;
      display: flex; justify-content: center; align-items: center;
    }
    .header-text {
      display: flex; align-items: center; justify-content: center;
      font-size: clamp(1.2rem, 4vw, 2.2rem);
      letter-spacing: 2px;
      color: #ffffff;
      text-align: center;
      text-shadow: 0 0 8px #ffffff, 0 0 25px #378b29;
    }
    .logo {
      width: clamp(50px, 15vw, 90px);
      height: clamp(50px, 15vw, 90px);
      margin: 0 0.5rem;
      cursor: pointer;
      border-radius: 50%;
      background: radial-gradient(circle, #264653aa, #000);
      box-shadow: 0 0 20px #378b29, 0 0 40px #ffffff;
      transition: transform 0.3s ease;
    }
    .logo:hover { transform: scale(1.1) rotate(5deg); }
    footer {
      position: fixed; bottom: 0; left: 0; width: 100%;
      padding: 1rem 0;
      border-top: 3px solid #ffffff;
      background: rgba(0, 100, 0, 0.9);
      box-shadow: 0 0 25px #ffffff, 0 0 50px #378b29 inset;
      text-align: center;
    }
    #footer-secret {
      font-size: 1rem;
      color: #ffffff;
      text-shadow: 0 0 8px #378b29, 0 0 25px #ffffff;
    }
    main { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 2rem; text-align: center; }
    h1 { margin-bottom: 1rem; color: #ffffff; text-shadow: 0 0 10px #378b29; }
    #treeCanvas { background: transparent; border-radius: 8px; }
    .controls { margin-top: 1rem; display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; }
    .controls select, .controls button { background: #378b29; color: #fff; border: none; padding: 0.5rem 1rem; border-radius: 6px; font-size: 1rem; cursor: pointer; }
    .controls button:hover { background: #ff0000; color: #fff; }
  </style>
</head>
<body>
  <div class="page-wrapper">
    <header>
      <div class="header-text">
        <span class="left-text">Cameron</span>
        <a href="../index.html"><img src="../img/cam.png" alt="Cam's Logo" class="logo"></a>
        <span class="right-text">Hollabaugh</span>
      </div>
    </header>
    <main>
      <h1>Christmas Tree Decorator</h1>
      <svg id="treeCanvas" viewBox="0 -60 300 460" width="360" height="520" xmlns="http://www.w3.org/2000/svg">
        <rect width="100%" height="100%" fill="#000"/>
        <polygon points="150,20 250,160 50,160" fill="#378b29"/>
        <polygon points="150,80 270,250 30,250" fill="#378b29"/>
        <polygon points="150,160 290,340 10,340" fill="#378b29"/>
        <rect x="125" y="340" width="50" height="60" fill="#8B4513" rx="4"/>
        <image id="starImg" href="../img/cam.png" x="115" y="-40" width="70" height="70" preserveAspectRatio="xMidYMid meet" />
      </svg>
      <div class="controls">
        <select id="decorationColor">
          <option value="#ff0000">Red</option>
          <option value="#ffffff">White</option>
          <option value="#378b29">Green</option>
          <option value="#ffff00">Yellow</option>
          <option value="#0000ff">Blue</option>
          <option value="#ff00ff">Magenta</option>
          <option value="#00ffff">Cyan</option>
          <option value="#ffa500">Orange</option>
        </select>
        <button id="clearBtn">Clear</button>
        <button id="exportBtn">Export PNG</button>
      </div>
    </main>
    <footer>
      <p id="footer-secret">Â©2025 Cameron Hollabaugh</p>
    </footer>
  </div>
  <script>
    const svg = document.getElementById('treeCanvas');
    svg.addEventListener('click', (e) => {
      const pt = svg.createSVGPoint();
      pt.x = e.clientX; pt.y = e.clientY;
      const loc = pt.matrixTransform(svg.getScreenCTM().inverse());
      const color = document.getElementById('decorationColor').value;
      const c = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
      c.setAttribute('cx', loc.x);
      c.setAttribute('cy', loc.y);
      c.setAttribute('r', 8);
      c.setAttribute('fill', color);
      svg.appendChild(c);
    });
    document.getElementById('clearBtn').addEventListener('click', () => { const els = svg.querySelectorAll('circle'); els.forEach(x => x.remove()); });
    async function exportPNG() {
      const clone = svg.cloneNode(true);
      const serializer = new XMLSerializer();
      let svgStr = serializer.serializeToString(clone);
      try {
        const res = await fetch('../img/cam.png');
        if (res.ok) {
          const blob = await res.blob();
          const reader = new FileReader();
          const dataUrl = await new Promise((resR, rejR) => { reader.onload = () => resR(reader.result); reader.onerror = rejR; reader.readAsDataURL(blob); });
          svgStr = svgStr.replace(/href=\"[^\"]*cam\\.png\"/, `href=\"${dataUrl}\"`);
        }
      } catch (e) {}
      const img = new Image();
      const svg64 = btoa(unescape(encodeURIComponent(svgStr)));
      img.src = 'data:image/svg+xml;base64,' + svg64;
      img.onload = () => {
        const vb = clone.getAttribute('viewBox').split(' ').map(Number);
        const w = vb[2];
        const h = vb[3];
        const canvas = document.createElement('canvas');
        canvas.width = w;
        canvas.height = h;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0);
        const link = document.createElement('a');
        link.download = 'tree.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
      };
      img.onerror = () => { alert('Export failed. If the star image is blocked by cross-origin rules, open this page from the same host as ../img/cam.png.'); };
    }
    document.getElementById('exportBtn').addEventListener('click', exportPNG);
  </script>
</body>
</html>
