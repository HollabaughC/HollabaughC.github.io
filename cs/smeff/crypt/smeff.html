<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The Crypt</title>
  <link rel="shortcut icon" href="../img/smeff.png" type="image/x-icon">
  <style>
    :root{
      --bg:#07090c;
      --stone:#1a1c22;
      --accent:#2a8ad1;
      --muted: rgba(255,255,255,0.05);
      --text: #dfe9f2;
    }
    html,body{height:100%;}
    body{
      margin:0;font-family:"EB Garamond",serif;
      background:
        linear-gradient(180deg,rgba(5,7,10,0.95),rgba(2,3,5,1)),
        url('https://upload.wikimedia.org/wikipedia/commons/5/5f/Lund_Domkyrka_crypt.jpg') center/cover no-repeat fixed;
      background-blend-mode:multiply;
      color:var(--text);display:flex;align-items:center;justify-content:center;padding:16px;box-sizing:border-box;
    }

    .app{
      width:880px;max-width:100%;background:rgba(10,12,16,0.85);
      border-radius:14px;padding:16px;box-shadow:0 10px 60px rgba(0,0,0,0.8) inset,0 0 80px rgba(10,20,40,0.6);
      position:relative;overflow:hidden;border:1px solid var(--muted);
    }

    header{text-align:center;margin-bottom:10px}
    h1{margin:0;font-size:20px;letter-spacing:0.6px}
    p.lead{margin:2px 0 0 0;color:rgba(230,242,251,0.75);font-size:14px}

    .crypt-area{margin-top:12px;display:flex;flex-direction:column;gap:16px;align-items:center}

    .scene{
      background:linear-gradient(180deg, rgba(5,9,12,0.8), rgba(3,5,7,0.95));
      border-radius:10px;padding:18px;min-height:360px;position:relative;overflow:hidden;border:1px solid rgba(255,255,255,0.05);
      width:100%;max-width:600px;display:flex;align-items:center;justify-content:center;
    }

    .spirit-wrap{position:relative;display:flex;justify-content:center;align-items:center}
    .spirit{
      width:260px;max-width:70vw;opacity:0.8;
      filter:grayscale(1) hue-rotate(180deg) saturate(2) brightness(1.2);
      mix-blend-mode:screen;display:block;border-radius:12px;
      animation:floaty 8s ease-in-out infinite alternate;
      background:radial-gradient(circle at center, rgba(20,40,80,0.4) 0%, rgba(0,0,20,0.0) 70%);
      padding:20px;border-radius:50%;
    }
    @keyframes floaty {
      0% { transform:translateY(0) scale(1); }
      50% { transform:translateY(-15px) scale(1.05); }
      100% { transform:translateY(10px) scale(1); }
    }

    .smoke{position:absolute;inset:0;pointer-events:none;mix-blend-mode:overlay;opacity:0.25;background-image:radial-gradient(circle at 20% 20%, rgba(200,230,255,0.02), transparent 6%), radial-gradient(circle at 80% 80%, rgba(100,150,200,0.03), transparent 10%)}

    .bubble{position:absolute;left:50%;top:10%;transform:translateX(-50%);max-width:80%;background:linear-gradient(180deg, rgba(26,38,60,0.9), rgba(12,20,32,0.85));padding:10px 14px;border-radius:12px;border:1px solid rgba(255,255,255,0.08);font-weight:600;color:var(--text);box-shadow:0 10px 30px rgba(2,6,23,0.7);opacity:0;transition:opacity .35s,transform .45s;font-size:14px;text-align:center}
    .bubble.show{opacity:1;transform:translate(-50%,-6px)}
    .bubble:after{content:'';position:absolute;left:50%;bottom:-12px;transform:translateX(-50%);border-width:8px;border-style:solid;border-color:rgba(12,20,32,0.85) transparent transparent transparent}

    aside.controls{text-align:center;margin-top:8px}

    button.ask{padding:8px 16px;border-radius:8px;border:0;background:linear-gradient(180deg,var(--accent),#0b5c8f);color:white;font-weight:600;font-size:14px;cursor:pointer;box-shadow:0 4px 10px rgba(16,100,170,0.25);max-width:260px;width:100%}
    button.ask:active{transform:translateY(1px)}

    footer.note{position:absolute;right:10px;bottom:8px;font-size:11px;color:rgba(230,242,251,0.18)}

    .typed{font-family:monospace;font-weight:700;letter-spacing:0.6px}
    .glow{filter:drop-shadow(0 6px 18px rgba(31,143,209,0.25))}

    @media (max-width:600px){
      h1{font-size:18px}
      .scene{min-height:300px;padding:12px}
      .spirit{width:200px;padding:12px}
      .bubble{font-size:13px;padding:8px 12px}
    }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="Lund crypt — ask the spirit">
    <header>
      <h1>Lund, Sweden — The Crypt</h1>
      <p class="lead">You enter the crypt beneath Lund Cathedral. A spirit waits to answer one question.</p>
    </header>

    <div class="crypt-area">
      <section class="scene" aria-live="polite">
        <div class="smoke" aria-hidden="true"></div>
        <div class="spirit-wrap">
          <img class="spirit" src="../img/smeff.png" alt="The spirit of SMEFF" />
        </div>
        <div class="bubble" id="bubble" role="status" aria-atomic="true"><span id="bubble-text"></span></div>
      </section>

      <aside class="controls">
        <button class="ask" id="askBtn" aria-controls="bubble">Ask the spirit who invented Smeff</button>
      </aside>
    </div>

    <footer class="note">Tip: Allow your browser to use speech to hear the spirit.</footer>
  </div>

  <script>
    const askBtn = document.getElementById('askBtn');
    const bubble = document.getElementById('bubble');
    const bubbleText = document.getElementById('bubble-text');

    const SPIRIT_ANSWER = '6,000 years ago, Cameron created me to create the first game of Mancala';

    function typeText(elem, text, speed=60){
      elem.textContent = '';
      let i=0;
      return new Promise(resolve=>{
        const t = setInterval(()=>{
          elem.textContent += text.charAt(i);
          i++;
          if(i>=text.length){ clearInterval(t); resolve(); }
        }, speed);
      });
    }

    function speak(text){
      if('speechSynthesis' in window){
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'en-US';
        u.rate = 0.30;
        u.pitch = 0.9;
        u.volume = 1.0;
        window.speechSynthesis.cancel();
        window.speechSynthesis.speak(u);
      }
    }

    let asked = false;
    askBtn.addEventListener('click', async ()=>{
      if(asked) return;
      asked = true;

      bubble.classList.add('show');
      bubbleText.classList.add('typed');

      await new Promise(r=>setTimeout(r,400));
      try{ speak(SPIRIT_ANSWER); }catch(e){ }
      await typeText(bubbleText, SPIRIT_ANSWER, 120);

      bubble.classList.add('glow');
      setTimeout(()=>{ asked = false; }, 2500);
    });

    askBtn.addEventListener('keydown', (e)=>{ if(e.key === 'Enter' || e.key === ' ') askBtn.click(); });
  </script>
</body>
</html>
